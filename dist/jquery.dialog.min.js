/*
* jqDialog - jQuery plugin for creating dialog hovering div
*
* Version: 0.0.1
* Build: 4
* Copyright 2011 Alex Tkachev
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: 01/08/2011 16:44:45
*/

(function(a){a.dialog={},a.dialog.i18n=a.i18n(),a.dialog.defaults={type:"simple",content:"",position:{my:"left top",at:"left bottom"},events:{},buttons:{},toolbar:[]},a.dialog.types={}})(jQuery),function(a){var b=function(){this.initialize.apply(this,arguments)};a.extend(b.prototype,{initialize:function(){},_createButtons:function(b){var c=this,d=a("div.toolbar",this.el).html("");for(var e=0;e<b.toolbar.length;e++){var f=b.toolbar[e],g=b.buttons[f];g.name=f;var h=a('<a href="javascript:;"/>').addClass(g.cls).html(g.text||a.dialog.i18n.t("buttons."+g.name));d.append(h),h.click({cfg:g},function(b){var d=b.data.cfg;d.keepVisible||a.dialog.hide();var e=c._dialogReturnData(d.name);d.action&&d.action(e),c._invokeCallback(d.name,b,e)})}},show:function(b){this.options=b,this.el||(this.el=this._createUI()),this._createButtons(b),a("div.content",this.el).html(b.type.render(this)),a("div.container",this.el).attr("class","container "+b.clsType),this.el.show(),b.position.of.css("direction")=="rtl"&&(b.position.my=b.position.my.replace("right","_l").replace("left","_r").replace("_l","left").replace("_r","right"),b.position.at=b.position.at.replace("right","_l").replace("left","_r").replace("_l","left").replace("_r","right"));var c=a("div.tip",this.el),d=b.position.my.indexOf("bottom")>=0;c.toggleClass("above",d).toggleClass("below",!d);var e=b.position.at.indexOf("right")>=0;b.position.offset="0 "+(d?-c.height():c.height()),this.el.position(b.position),c.position({my:b.position.at,at:b.position.my,of:a("div.container",this.el),offset:(e?-c.width():c.width())+" 0"}),a(document).bind("mousedown",{dialog:this},this._onDocumntMouseDown),this._invokeCallback("show")},hide:function(){a(document).unbind("mousedown",this._onDocumntMouseDown),this.el.hide(),this._invokeCallback("hide")},_createUI:function(){return a('<div class="dialog-container"><div class="tip"/><div class="container"><div class="content"/><div class="toolbar"/></div></div>').appendTo("body").hide()},_invokeCallback:function(b){var c=this.options.events[b];a.isFunction(c)&&c.apply(this.options.events.context||this,Array.prototype.slice.call(arguments,1)),a.isFunction(this.options.events.callback)&&this.options.events.callback.apply(this.options.events.context||this,Array.prototype.slice.call(arguments,1))},_dialogReturnData:function(a){return this.options.type.returnData?this.options.type.returnData(a):undefined},_onDocumntMouseDown:function(b){var c=a(b.target);c.closest("div.dialog-container").length===0&&b.data.dialog.hide()}});var c=new b;a.extend(a.dialog,{el:function(){return c.el},show:function(b){b=a.extend({type:a.dialog.defaults.type},b||{});var d=a.dialog.types[b.type];if(!a.isFunction(d))throw"unknown dialog type "+d;b=a.extend(!0,{},a.dialog.defaults,d.defaults||{},b,{type:new d}),c.show(b)},hide:function(){c.hide()}})}(jQuery),function(a){var b=function(){this.initialize.apply(this,arguments)};b.defaults={clsType:"simple",buttons:{close:{}},toolbar:["close"]},a.extend(b.prototype,{initialize:function(){},render:function(a){return a.options.content}}),a.dialog.types.simple=b}(jQuery),function(a){var b=function(){this.initialize.apply(this,arguments)};b.defaults={clsType:"confirm",buttons:{yes:{},no:{}},toolbar:["yes","no"]},a.extend(b.prototype,{initialize:function(){},render:function(b){return b.options.content||a.dialog.i18n.t("confirm.message")}}),a.dialog.types.confirm=b}(jQuery)