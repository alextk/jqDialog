/*
* jqDialog - jQuery plugin for rendering dialog
*
* Version: 0.0.1a
* Copyright 2011 Alex Tkachev
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Sun Jul 10 11:16:58 2011 +0300
*/
(function(a){function c(){return a('<div class="dialog-container"><div class="tip"/><div class="content"/></div>').appendTo("body").hide()}var b=function(){this.initialize.apply(this,arguments)};a.extend(b.prototype,{initialize:function(){},show:function(b){this.options=b,this.el||(this.el=c()),a("div.content",this.el).html(b.type(this)),this.el.show();var d=a("div.tip",this.el),e=b.position.my.indexOf("bottom")>=0;d.toggleClass("above",e).toggleClass("below",!e);var f=b.position.at.indexOf("right")>=0;b.position.offset="0 "+(e?-d.height():d.height()),this.el.position(b.position),d.position({my:b.position.at,at:b.position.my,of:a("div.content",this.el),offset:(f?-d.width():d.width())+" 0"}),a(document).bind("mousedown",{dialog:this},this.onDocumntMouseDown),this.invokeCallback("show")},hide:function(){a(document).unbind("mousedown",this.onDocumntMouseDown),this.el.hide(),this.invokeCallback("hide")},invokeCallback:function(b){var c=this.options.events[b];a.isFunction(c)&&c.apply(this.options.events.context||c)},onDocumntMouseDown:function(b){var c=a(b.target);c.closest("div.dialog-container").length===0&&b.data.dialog.hide()}}),a.fn.dialog=function(a){},a.fn.dialog.types={simple:function(a){return a.options.content},confirm:function(){function b(b){var c=a('<div class="confirmation-dialog-content"><div class="message"/><div class="toolbar"><a href="javascript:;" class="yes"/><a href="javascript:;" class="no"/></div></div>');a("a.yes",c).html(b.yes.text).addClass(b.yes.cls),a("a.no",c).html(b.no.text).addClass(b.no.cls),a("div.message",c).html(b.message);return c}var c=function(c){var d=c.options,e=b(d.content);a("a.no",e).click(function(){a.dialog.hide(),c.invokeCallback("no")}),a("a.yes",e).click(function(){a.dialog.hide(),c.invokeCallback("yes")});return e};c.defaults={content:{message:"are you sure?",yes:{text:"Yes",cls:"button"},no:{text:"No",cls:"button"}}};return c}()},a.fn.dialog.defaults={type:"simple",content:"",position:{my:"left top",at:"left bottom"},events:{}};var d=new b;a.dialog=function(b){b=a.extend({type:a.fn.dialog.defaults.type},b||{});var c=b.type=a.fn.dialog.types[b.type];if(!a.isFunction(c))throw"unknown dialog type "+b.type;b=a.extend(!0,{},a.fn.dialog.defaults,c.defaults||{},b),d.show(b)},a.extend(a.dialog,{hide:function(){d.hide()}})})(jQuery)